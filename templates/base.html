{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="{% static 'images/favicon.svg' %}">
    <title>{% block title %}{% endblock %} — Instant Placement</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f0f13;
            color: #f1f5f9;
        }

        .glass {
            background: rgba(26, 26, 46, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(42, 42, 74, 0.5);
        }

        .text-gradient {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .btn-gradient {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            transition: all 0.3s ease;
        }

        .btn-gradient:hover {
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.4);
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0f0f13;
        }

        ::-webkit-scrollbar-thumb {
            background: #6366f1;
            border-radius: 10px;
        }

        @keyframes fadeInRight {
            from {
                opacity: 0;
                transform: translateX(20px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .animate-fade-in-right {
            animation: fadeInRight 0.5s ease forwards;
        }
    </style>
    {% block extra_head %}{% endblock %}
</head>

<body class="min-h-screen flex flex-col overflow-x-hidden">
    <!-- Decorative Blob -->
    <div class="fixed top-0 right-0 w-96 h-96 bg-indigo-600/10 rounded-full blur-[100px] -z-10"></div>

    <!-- Navbar -->
    <nav class="sticky top-0 z-50 glass border-b border-[#2a2a4a]">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center">
                    <a href="{% url 'landing' %}" class="flex items-center space-x-3 group">
                        <div class="p-2 bg-indigo-600 rounded-lg shadow-lg group-hover:rotate-12 transition-transform">
                            <i data-lucide="zap" class="w-5 h-5 text-white fill-white"></i>
                        </div>
                        <span class="text-xl font-bold tracking-tight">Instant <span
                                class="text-gradient">Placement</span></span>
                    </a>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="{% url 'home' %}"
                        class="text-sm font-medium hover:text-indigo-400 transition-colors">Search</a>
                    <a href="{% url 'pricing' %}"
                        class="text-sm font-medium hover:text-indigo-400 transition-colors">Pricing</a>
                    {% if user.is_authenticated %}
                    <a href="{% url 'saved_jobs' %}"
                        class="text-sm font-medium hover:text-indigo-400 transition-colors">Saved Jobs</a>
                    {% if user.profile.is_pro %}
                    <a href="{% url 'alerts' %}"
                        class="text-sm font-medium hover:text-indigo-400 transition-colors">Alerts</a>
                    {% endif %}
                    <div class="flex items-center space-x-4 ml-4">
                        {% if user.profile.is_pro %}
                        <span
                            class="px-2 py-0.5 text-[10px] font-bold bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full">PRO</span>
                        {% endif %}
                        <a href="{% url 'profile' %}"
                            class="w-8 h-8 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center font-bold text-white text-xs ring-2 ring-indigo-500/50">
                            {{ user.email|slice:":1"|upper }}
                        </a>
                        <form method="post" action="{% url 'account_logout' %}">
                            {% csrf_token %}
                            <button type="submit"
                                class="text-sm font-medium text-gray-400 hover:text-white transition-colors">Logout</button>
                        </form>
                    </div>
                    {% else %}
                    <a href="{% url 'account_login' %}"
                        class="text-sm font-medium hover:text-indigo-400 text-gray-400 transition-colors">Login</a>
                    <a href="{% url 'account_signup' %}"
                        class="btn-gradient px-6 py-2 rounded-full text-sm font-bold shadow-lg shadow-indigo-500/20">Get
                        Started Free</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow">
        {% if messages %}
        <div id="toast-container" class="fixed top-20 right-4 z-[100] flex flex-col space-y-2">
            {% for message in messages %}
            <div class="toast glass border-l-4 p-4 rounded-lg shadow-2xl animate-fade-in-right {% if message.tags == 'success' %}border-green-500{% elif message.tags == 'error' %}border-red-500{% else %}border-indigo-500{% endif %}"
                style="min-width: 300px;">
                <p class="text-sm font-medium">{{ message }}</p>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% block content %}{% endblock %}
    </main>

    <!-- Global Progress Overlay -->
    <div id="progress-overlay"
        class="fixed inset-0 z-[100] hidden flex-col items-center justify-center bg-[#0f0f13]/95 backdrop-blur-2xl transition-all duration-500">
        <div class="max-w-md w-full px-6 text-center animate-fade-in-up">
            <!-- Animated Progress Icon -->
            <div class="mb-12 relative inline-block">
                <div class="relative w-24 h-24 flex items-center justify-center">
                    <div
                        class="p-5 bg-indigo-600 rounded-2xl shadow-[0_0_30px_rgba(99,102,241,0.5)] animate-pulse relative z-10">
                        <i data-lucide="search" class="w-10 h-10 text-white"></i>
                    </div>
                    <!-- Spinning Rings -->
                    <div
                        class="absolute inset-0 border-2 border-indigo-500/20 border-t-indigo-500 rounded-full animate-spin">
                    </div>
                </div>
                <div
                    class="absolute -bottom-6 left-1/2 -translate-x-1/2 w-12 h-1 bg-indigo-500/40 blur-sm rounded-full animate-pulse">
                </div>
            </div>

            <h2 id="progress-title" class="text-3xl font-bold mb-4 tracking-tight text-white">Scanning Jobs In Market...
            </h2>

            <!-- Progress Bar Container -->
            <div class="w-full h-3 bg-gray-900/50 rounded-full overflow-hidden mb-8 relative border border-white/5">
                <div id="progress-bar"
                    class="absolute top-0 left-0 h-full bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-600 w-0 transition-all duration-300 ease-out shadow-[0_0_25px_rgba(99,102,241,0.6)]">
                </div>
                <!-- Shimmer effect -->
                <div
                    class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent w-1/2 -skew-x-12 animate-[shimmer_2s_infinite]">
                </div>
            </div>

            <div class="space-y-4">
                <p id="progress-status" class="text-indigo-400 font-bold tracking-wide animate-pulse uppercase text-sm">
                    Initializing connection to job boards...</p>
                <p class="text-gray-500 text-xs italic">"Success is where preparation and opportunity meet."</p>
            </div>

            <div class="mt-16 grid grid-cols-2 gap-4">
                <div
                    class="glass py-4 rounded-2xl text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] border-indigo-500/10 transition-colors group">
                    <span class="group-hover:text-indigo-400 transition-colors">LinkedIn</span>
                </div>
                <div
                    class="glass py-4 rounded-2xl text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] border-indigo-500/10 transition-colors group">
                    <span class="group-hover:text-indigo-400 transition-colors">Indeed</span>
                </div>
                <div
                    class="glass py-4 rounded-2xl text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] border-indigo-500/10 transition-colors group">
                    <span class="group-hover:text-indigo-400 transition-colors">Glassdoor</span>
                </div>
                <div
                    class="glass py-4 rounded-2xl text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] border-indigo-500/10 transition-colors group">
                    <span class="group-hover:text-indigo-400 transition-colors">ZipRecruiter</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-[#0f0f13] border-t border-[#2a2a4a] py-8 mt-12">
        <div
            class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center text-sm text-gray-400">
            <div class="flex items-center space-x-3 mb-6 md:mb-0">
                <div class="p-1.5 bg-indigo-600 rounded-lg shadow-lg">
                    <i data-lucide="zap" class="w-4 h-4 text-white fill-white"></i>
                </div>
                <span class="text-lg font-bold tracking-tight">Instant <span
                        class="text-gradient">Placement</span></span>
            </div>
            <div class="flex space-x-8 mb-6 md:mb-0">
                <a href="{% url 'home' %}"
                    class="hover:text-white transition-colors underline decoration-transparent hover:decoration-indigo-500 underline-offset-4">Home</a>
                <a href="{% url 'pricing' %}"
                    class="hover:text-white transition-colors underline decoration-transparent hover:decoration-indigo-500 underline-offset-4">Pricing</a>
                <a href="{% url 'account_login' %}"
                    class="hover:text-white transition-colors underline decoration-transparent hover:decoration-indigo-500 underline-offset-4">Login</a>
            </div>
            <div class="text-xs text-gray-600">
                © 2026 Instant Placement. Designed with <i data-lucide="heart"
                    class="inline-block w-3 h-3 text-red-500 fill-red-500"></i>
            </div>
        </div>
    </footer>

    <style>
        @keyframes shimmer {
            0% {
                transform: translateX(-200%) skewX(-12deg);
            }

            100% {
                transform: translateX(200%) skewX(-12deg);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in-up {
            animation: fadeInUp 0.5s ease forwards;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }
    </style>

    <script>
        // Toast handling
        setTimeout(() => {
            const container = document.getElementById('toast-container');
            if (container) {
                container.style.opacity = '0';
                container.style.transition = 'opacity 0.5s ease';
                setTimeout(() => container.remove(), 500);
            }
        }, 4000);

        // Progress Overlay Logic
        const progressMessages = [
            "Connecting to job APIs...",
            "Matching your profile with opportunities...",
            "Scanning LinkedIn for hidden gems...",
            "Filtering Indeed for fresh posts...",
            "Analyzing Glassdoor company reviews...",
            "Optimizing results for your preferences...",
            "Almost there! Preparing your dashboard...",
            "Curating the best roles for you...",
            "Bypassing duplicate listings...",
            "Verifying job availability..."
        ];

        function showProgress() {
            const overlay = document.getElementById('progress-overlay');
            const progressBar = document.getElementById('progress-bar');
            const statusText = document.getElementById('progress-status');
            const titleText = document.getElementById('progress-title');
            const badges = overlay.querySelectorAll('.glass');

            overlay.classList.remove('hidden');
            overlay.classList.add('flex');
            document.body.style.overflow = 'hidden';

            let progress = 0;
            let messageIndex = 0;

            const interval = setInterval(() => {
                if (progress < 95) {
                    const increment = Math.max(0.2, (100 - progress) / 30);
                    progress += increment;
                    progressBar.style.width = `${progress}%`;
                }

                // Randomly highlight badges
                if (Math.random() > 0.5) {
                    const randomBadge = badges[Math.floor(Math.random() * badges.length)];
                    badges.forEach(b => {
                        b.classList.remove('border-indigo-500', 'bg-indigo-500/10', 'text-indigo-400');
                        b.classList.add('border-indigo-500/10', 'text-gray-500');
                    });
                    randomBadge.classList.remove('border-indigo-500/10', 'text-gray-500');
                    randomBadge.classList.add('border-indigo-500', 'bg-indigo-500/10', 'text-indigo-400');
                }

                if (Math.random() > 0.8) {
                    messageIndex = (messageIndex + 1) % progressMessages.length;
                    statusText.innerText = progressMessages[messageIndex];

                    if (progress > 50 && titleText.innerText !== "Finding the Perfect Match...") {
                        titleText.innerText = "Finding the Perfect Match...";
                    }
                }
            }, 400);

            // Cleanup if page unloads (though navigation will handle it)
            window.addEventListener('beforeunload', () => clearInterval(interval));
        }

        // Auto-attach to forms with data-progress attribute
        document.addEventListener('submit', (e) => {
            if (e.target.hasAttribute('data-show-progress')) {
                showProgress();
            }
        });

        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>

</html>